/** @file gsExport.h

    @brief Handles shared library creation and other class attribures

    By default no symbols are exported in the shared library. Symbols
    that have to be exported must be marked with GISMO_EXPORT. Symbols
    that should not be exported can be marked with GISMO_LOCAL.
    Also:

    - When building the shared library, gismo_EXPORTS must be defined,
      but NOT when consuming G+Smo as a shared library

    - When building the static library, gismo_STATIC must be defined
    
    - If GISMO_BUILD_LIB is defined when building or consuming the shared or
      static library. Otherwise a pure template build will take place
      (GISMO_BUILD_LIB is set in gsCore/gsConfig.h when G+Smo is
      compiled/installed as a shared library).

    This file is part of the G+Smo library. 
    
    This Source Code Form is subject to the terms of the Mozilla Public
    License, v. 2.0. If a copy of the MPL was not distributed with this
    file, You can obtain one at http://mozilla.org/MPL/2.0/.

    Author(s): A. Mantzaflaris
*/

#pragma once

#include <gsCore/gsConfig.h>

#if defined(@PROJECT_NAME@_STATIC) // using/building static library?

#  define GISMO_EXPORT
#  define GISMO_LOCAL

#elif defined(@PROJECT_NAME@_EXPORTS) // building shared library?

#  if defined(_WIN32) || defined(__CYGWIN__)
#    define GISMO_EXPORT __declspec(dllexport)
#    define GISMO_LOCAL
#  else						                
#    define GISMO_EXPORT __attribute__((visibility("default")))
#    define GISMO_LOCAL  __attribute__((visibility("hidden" )))
#  endif

#else // using shared library?

#  if defined(_WIN32) || defined(__CYGWIN__)
#    define GISMO_EXPORT __declspec(dllimport)
#    define GISMO_LOCAL
#  else
#    define GISMO_EXPORT
#    define GISMO_LOCAL
#  endif

#endif


/*
  GISMO_FINAL
  Marks a virtual method indicating that derived classes cannot
  override it, or mark a class to indicate that there can be no
  derived classes.

  Example:
  virtual void foo() GISMO_FINAL;
  class B GISMO_FINAL : public A {};

  GISMO_OVERRIDE
  Marks a virtual method indicating it must be overriding a virtual
  method of the base class
  
  Example:
  virtual void foo() GISMO_OVERRIDE;
*/
#if defined(_MSC_VER)
// MSVC2010 uses "sealed"
#define GISMO_FINAL sealed
#define GISMO_OVERRIDE override
#elif defined(__clang__ ) && __has_feature(cxx_override_control)
#define GISMO_FINAL final
#define GISMO_OVERRIDE override
#elif defined(__GNUG__) && __cplusplus >= 201103 && \
(__GNUC__ * 10000 + __GNUC_MINOR__ * 100) >= 40700
// GCC 4.7 supports with C++11 enabled
#define GISMO_FINAL final
#define GISMO_OVERRIDE override
#else
#define GISMO_FINAL
#define GISMO_OVERRIDE
#endif
